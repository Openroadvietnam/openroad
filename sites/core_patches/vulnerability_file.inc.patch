Index: includes/file.inc
===================================================================
--- includes/file.inc	(revision 1253)
+++ includes/file.inc	(working copy)
@@ -134,7 +134,9 @@
  * @return FALSE when directory not found, or TRUE when directory exists.
  */
 function file_check_directory(&$directory, $mode = 0, $form_item = NULL) {
-  $directory = rtrim($directory, '/\\');
+   //$directory = rtrim($directory, '/\\');
+   //Modified to remove the possibility of Path Manipulation
+   $directory = filter_var ( $directory, FILTER_SANITIZE_SPECIAL_CHARS );
 
   // Check if directory exists.
   if (!is_dir($directory)) {
